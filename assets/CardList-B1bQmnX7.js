import{j as t,M as _,r as l,B as M,u as I,a as N,w as S,i as z}from"./index-Br30AL2J.js";var C=(e=>(e[e.notAuth=401]="notAuth",e[e.serverOut=500]="serverOut",e[e.invalidRequest=400]="invalidRequest",e))(C||{});function L({error:e}){let s="";switch(e.status){case C.notAuth:s="Ошибка авторизации";break;case C.invalidRequest:s=e.data.message;break;case 500:s="Все упало";break;default:s=e.error;break}return t.jsx(_,{message:s})}function T(){return t.jsx("div",{className:"loader"})}function V(){return t.jsxs("div",{className:"loading",children:[t.jsx(T,{}),t.jsx("p",{children:"Подгрузка компаний"})]})}const O=({card:e})=>{const{mobileAppDashboard:s,customerMarkParameters:r}=e,n={color:s.highlightTextColor},i={color:s.textColor};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card__title",children:[t.jsx("h2",{style:n,children:s.companyName}),t.jsx("img",{src:s.logo})]}),t.jsxs("div",{className:"card__info",children:[t.jsxs("p",{className:"card__desc",style:i,children:[t.jsx("span",{className:"card__desc--ball",style:n,children:r.mark}),"баллов"]}),t.jsx("div",{className:"card__desc--other",children:t.jsxs("dl",{className:"card__desc-list",children:[t.jsxs("div",{className:"list__item",children:[t.jsx("dt",{style:i,children:"Кешбэк"}),t.jsxs("dd",{children:[r.loyaltyLevel.number,"%"]})]}),t.jsxs("div",{className:"list__item",children:[t.jsx("dt",{style:i,children:"Уровень"}),t.jsxs("dd",{children:[r.loyaltyLevel.name," уровень"]})]})]})})]})]})},F=e=>l.createElement("svg",{fill:"#000000",xmlns:"http://www.w3.org/2000/svg",width:"512.000000pt",height:"512.000000pt",viewBox:"0 0 512.000000 512.000000",preserveAspectRatio:"xMidYMid meet",...e},l.createElement("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",stroke:"none"},l.createElement("path",{d:"M2320 4549 c-764 -69 -1431 -451 -1949 -1117 -181 -232 -295 -433 -342 -602 -21 -75 -24 -106 -24 -270 0 -163 3 -195 24 -270 89 -325 463 -814 881 -1153 362 -294 815 -487 1300 -554 172 -23 528 -23 700 0 731 101 1345 470 1838 1104 182 233 296 434 343 603 21 75 24 106 24 270 0 164 -3 195 -24 270 -47 169 -161 370 -342 602 -494 635 -1113 1007 -1834 1103 -147 20 -453 27 -595 14z m590 -453 c653 -112 1222 -506 1631 -1129 91 -138 126 -220 141 -328 23 -165 -17 -300 -147 -495 -370 -556 -867 -932 -1422 -1074 -171 -45 -287 -60 -488 -67 -376 -12 -686 54 -1021 217 -390 189 -743 509 -1019 924 -92 139 -132 228 -147 336 -23 166 16 300 147 496 377 566 885 944 1455 1083 63 16 156 34 205 40 50 6 101 13 115 15 61 11 460 -3 550 -18z"}),l.createElement("path",{d:"M2374 3616 c-232 -44 -406 -136 -570 -300 -142 -141 -230 -294 -282 -485 -23 -86 -26 -114 -26 -271 0 -157 3 -185 26 -271 101 -375 392 -666 764 -766 89 -24 116 -27 274 -27 158 0 185 3 274 27 372 100 663 392 764 766 22 85 26 116 26 266 1 195 -15 277 -82 432 -54 126 -121 223 -226 329 -144 144 -308 237 -500 285 -105 27 -340 34 -442 15z m281 -431 c212 -23 414 -189 502 -410 26 -65 28 -80 28 -215 0 -140 -1 -148 -32 -225 -59 -146 -183 -280 -319 -345 -91 -44 -167 -61 -274 -61 -107 0 -183 17 -274 61 -136 65 -260 199 -319 345 -31 77 -32 85 -32 225 0 135 2 150 28 215 72 181 205 314 381 380 66 25 185 45 236 39 14 -2 48 -6 75 -9z"}))),q=e=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"512.000000pt",height:"512.000000pt",viewBox:"0 0 512.000000 512.000000",preserveAspectRatio:"xMidYMid meet",...e},l.createElement("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",stroke:"none"},l.createElement("path",{d:"M2136 5105 c-395 -81 -723 -387 -823 -770 l-17 -64 -367 -3 -367 -3 -44 -30 c-136 -97 -124 -301 23 -376 32 -16 59 -19 173 -19 l136 0 2 -1472 3 -1473 27 -97 c95 -345 342 -617 671 -738 158 -58 110 -55 1007 -55 l825 0 85 23 c108 29 286 116 370 180 196 149 332 351 398 590 l27 97 3 1473 2 1472 136 0 c153 0 189 11 242 76 81 98 60 244 -46 319 l-44 30 -367 3 -367 3 -17 64 c-94 361 -389 653 -765 758 -72 19 -104 21 -457 23 -294 2 -396 0 -449 -11z m829 -449 c179 -62 323 -191 389 -349 l15 -37 -809 0 -809 0 15 37 c78 185 272 336 477 372 29 5 185 9 347 7 294 -2 295 -2 375 -30z m873 -2248 c-4 -1599 2 -1470 -75 -1627 -48 -100 -168 -222 -268 -273 -148 -77 -102 -73 -935 -73 -833 0 -787 -4 -935 73 -101 52 -220 173 -268 272 -77 158 -71 28 -75 1628 l-3 1432 1281 0 1281 0 -3 -1432z"}),l.createElement("path",{d:"M2033 2965 c-32 -16 -61 -41 -79 -67 l-29 -41 -3 -712 -2 -711 23 -45 c13 -24 43 -57 66 -74 39 -27 50 -30 125 -30 75 0 87 3 124 29 26 18 51 47 67 79 l25 51 0 690 c0 651 -2 693 -19 731 -52 113 -183 157 -298 100z"}),l.createElement("path",{d:"M2895 2971 c-22 -10 -52 -31 -67 -47 -60 -64 -58 -40 -58 -792 l0 -688 25 -51 c38 -75 89 -107 179 -111 91 -4 146 22 194 92 l32 49 -2 717 -3 717 -29 41 c-56 82 -180 115 -271 73z"})));function B(e){const[s,r]=l.useState(e);return[s,()=>{r(!s)}]}const W=({companyId:e})=>t.jsxs("div",{children:[t.jsx("p",{children:"View"}),t.jsx("p",{children:e})]}),Y=({companyId:e})=>t.jsxs("div",{children:[t.jsx("p",{children:"Delete"}),t.jsx("p",{children:e})]}),$=({companyId:e})=>t.jsxs("div",{children:[t.jsx("p",{children:"Details"}),t.jsx("p",{children:e})]}),G=({accentColor:e,mainColor:s,backgroundColor:r,companyId:n})=>{const i={color:s,background:r},[o,c]=B(!1),[a,d]=B(!1),[m,h]=B(!1);return t.jsxs("div",{className:"card__nav",children:[t.jsx(M,{onClick:c,className:"card__nav--view",children:t.jsx(F,{fill:s})}),t.jsx(M,{onClick:d,className:"card__nav--del",children:t.jsx(q,{fill:e})}),t.jsx(M,{onClick:h,style:i,children:"Подробнее"}),o&&t.jsx(_,{cb:c,children:t.jsx(W,{companyId:n})}),a&&t.jsx(_,{cb:d,children:t.jsx(Y,{companyId:n})}),m&&t.jsx(_,{cb:h,children:t.jsx($,{companyId:n})})]})},D=({card:e,myref:s})=>{const{mobileAppDashboard:r}=e,{accentColor:n,mainColor:i,backgroundColor:o}=r,c={background:r.cardBackgroundColor};return t.jsxs("li",{className:"card__item",ref:s,style:c,children:[t.jsx(O,{card:e}),t.jsx(G,{accentColor:n,mainColor:i,backgroundColor:o,companyId:e.company.companyId})]})};var A=new Map,p=new WeakMap,k=0,P=void 0;function Q(e){return e?(p.has(e)||(k+=1,p.set(e,k.toString())),p.get(e)):"0"}function H(e){return Object.keys(e).sort().filter(s=>e[s]!==void 0).map(s=>`${s}_${s==="root"?Q(e.root):e[s]}`).toString()}function J(e){const s=H(e);let r=A.get(s);if(!r){const n=new Map;let i;const o=new IntersectionObserver(c=>{c.forEach(a=>{var d;const m=a.isIntersecting&&i.some(h=>a.intersectionRatio>=h);e.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=m),(d=n.get(a.target))==null||d.forEach(h=>{h(m,a)})})},e);i=o.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:s,observer:o,elements:n},A.set(s,r)}return r}function K(e,s,r={},n=P){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const d=e.getBoundingClientRect();return s(n,{isIntersecting:n,target:e,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:i,observer:o,elements:c}=J(r),a=c.get(e)||[];return c.has(e)||c.set(e,a),a.push(s),o.observe(e),function(){a.splice(a.indexOf(s),1),a.length===0&&(c.delete(e),o.unobserve(e)),c.size===0&&(o.disconnect(),A.delete(i))}}function U({threshold:e,delay:s,trackVisibility:r,rootMargin:n,root:i,triggerOnce:o,skip:c,initialInView:a,fallbackInView:d,onChange:m}={}){var h;const[f,b]=l.useState(null),g=l.useRef(),[u,j]=l.useState({inView:!!a,entry:void 0});g.current=m,l.useEffect(()=>{if(c||!f)return;let v;return v=K(f,(E,w)=>{j({inView:E,entry:w}),g.current&&g.current(E,w),w.isIntersecting&&o&&v&&(v(),v=void 0)},{root:i,rootMargin:n,threshold:e,trackVisibility:r,delay:s},d),()=>{v&&v()}},[Array.isArray(e)?e.toString():e,f,i,n,o,c,r,d,s]);const y=(h=u.entry)==null?void 0:h.target,R=l.useRef();!f&&y&&!o&&!c&&R.current!==y&&(R.current=y,j({inView:!!a,entry:void 0}));const x=[b,u.inView,u.entry];return x.ref=x[0],x.inView=x[1],x.entry=x[2],x}const Z=()=>{const e=I(),[s,r]=l.useState(!1),n=N(u=>u.data.offset),i=N(u=>u.data.limit),o=N(u=>u.data.loadAllCards),{data:c,isError:a,isFetching:d,error:m}=S.useGetCardsQuery({offset:n,limit:i}),h=(c==null?void 0:c.companies)??[],f=m,{ref:b,inView:g}=U({threshold:.5,triggerOnce:!0});return l.useEffect(()=>{g&&!s&&!o?(e(z()),r(!0)):r(!1)},[g]),t.jsxs("section",{className:"section__list",children:[t.jsx("h2",{children:"Управление картами"}),t.jsxs("ul",{className:"list__card",children:[h.map((u,j)=>j+1===h.length?t.jsx(D,{card:u,myref:b},u.company.companyId):t.jsx(D,{card:u},u.company.companyId)),d&&t.jsx(V,{})]}),a&&t.jsx(L,{error:f})]})};export{Z as default};
